# 🚀 Vercel 部署指南

## 🌟 为什么选择Vercel？

- ✅ **免费额度大**: 个人项目完全够用
- ✅ **全球CDN**: 访问速度快  
- ✅ **自动部署**: Git推送自动部署
- ✅ **支付宝支持**: Pro版支持支付宝付款
- ✅ **Serverless**: 无需服务器管理
- ✅ **HTTPS**: 自动SSL证书

## 📋 Vercel部署步骤

### 方法1: Web界面部署（推荐）

#### 1. 准备GitHub仓库
确保您的代码已推送到GitHub

#### 2. 访问Vercel
1. 打开 **vercel.com**
2. 点击 "Start Deploying"
3. 选择 "Continue with GitHub"
4. 授权Vercel访问您的GitHub

#### 3. 导入项目
1. 点击 "New Project"
2. 选择您的GitHub仓库 `Actor-Dataset-Construct`
3. 点击 "Import"

#### 4. 配置环境变量
在Vercel控制台设置：
```bash
TMDB_API_KEY=您的TMDB_API密钥
VERCEL_ENV=true
```

#### 5. 部署
1. Vercel自动检测到 `vercel.json` 配置
2. 点击 "Deploy"
3. 等待部署完成（约2-3分钟）

### 方法2: CLI部署

#### 1. 安装Vercel CLI
```bash
npm install -g vercel
```

#### 2. 登录
```bash
vercel login
```

#### 3. 部署
```bash
# 在项目根目录运行
vercel --prod
```

## ⚙️ 配置说明

### vercel.json配置文件
```json
{
  "name": "actor-face-recognition",
  "version": 2,
  "builds": [
    {
      "src": "api/index.py",
      "use": "@vercel/python"
    },
    {
      "src": "web/static/**",
      "use": "@vercel/static"
    }
  ],
  "routes": [
    {
      "src": "/static/(.*)",
      "dest": "/web/static/$1"
    },
    {
      "src": "/api/(.*)",
      "dest": "/api/index.py"
    },
    {
      "src": "/(.*)",
      "dest": "/web/static/index.html"
    }
  ]
}
```

### API入口文件
- **位置**: `api/index.py`
- **功能**: Serverless Functions入口
- **运行时**: Python 3.9

### 静态文件
- **位置**: `web/static/`
- **功能**: 前端静态资源
- **CDN**: 全球分发

## 💰 费用说明

### 免费计划（Hobby）
- ✅ **带宽**: 100GB/月
- ✅ **构建时间**: 6000分钟/月
- ✅ **函数调用**: 125,000次/月
- ✅ **域名**: vercel.app子域名
- ✅ **SSL**: 免费HTTPS

### Pro计划（$20/月）
- ✅ **支付宝付款**: 支持支付宝
- ✅ **更多资源**: 1TB带宽
- ✅ **自定义域名**: 无限制
- ✅ **团队协作**: 高级功能

## 🎯 项目特别优化

### Serverless适配
由于Vercel的Serverless限制，我们做了以下优化：

1. **精简依赖**: 移除大型包（InsightFace等）
2. **内存存储**: 使用内存替代Faiss
3. **函数拆分**: API拆分为多个小函数
4. **静态资源**: 前端独立部署

### 性能优化
- ⚡ **冷启动**: <2秒
- 🚀 **响应时间**: <500ms
- 📦 **包大小**: <50MB
- 🔄 **缓存**: Edge缓存

## 🌐 部署后访问

### 默认域名
```
https://actor-face-recognition.vercel.app
```

### 自定义域名（Pro版）
1. 在Vercel控制台添加域名
2. 配置DNS记录
3. 自动SSL证书

## 🔧 故障排除

### 常见问题

#### 1. 函数超时
```bash
解决：优化代码，减少处理时间
配置：maxDuration: 30s
```

#### 2. 包太大
```bash
解决：使用精简版依赖
文件：api/requirements.txt
```

#### 3. 环境变量
```bash
设置：Vercel控制台 → Settings → Environment Variables
格式：TMDB_API_KEY=your_key
```

## 🚀 部署检查清单

- [ ] ✅ GitHub仓库已准备
- [ ] ✅ `vercel.json` 配置文件存在  
- [ ] ✅ `api/index.py` 入口文件存在
- [ ] ✅ `api/requirements.txt` 依赖文件存在
- [ ] ✅ TMDB API密钥已获取
- [ ] ✅ Vercel账号已注册

## 📞 技术支持

### 部署成功标志
✅ 构建日志显示 "Build completed"
✅ 函数部署成功
✅ 静态资源部署成功  
✅ 域名可正常访问

### 需要帮助？
如果部署遇到问题，请提供：
1. 构建日志截图
2. 错误信息
3. 配置文件内容

我会为您提供详细的解决方案！

