# ä»£ç†é…ç½®æŒ‡å—

## ðŸŒ ä»£ç†è§£å†³æ–¹æ¡ˆ

### ä¸ºä»€ä¹ˆéœ€è¦ä»£ç†ï¼Ÿ
- ðŸš« **IPå°é”**: äº‘æœåŠ¡å™¨IPå¯èƒ½è¢«TMDBé™åˆ¶
- ðŸ›¡ï¸ **åçˆ¬ä¿æŠ¤**: TMDBæœ‰åçˆ¬è™«æœºåˆ¶
- ðŸŒ **åœ°ç†é™åˆ¶**: æŸäº›åœ°åŒºIPè®¿é—®å—é™
- ðŸ”„ **ç½‘ç»œçŽ¯å¢ƒ**: äº‘ç«¯ç½‘ç»œçŽ¯å¢ƒä¸Žæœ¬åœ°ä¸åŒ

## ðŸ› ï¸ ä»£ç†é…ç½®æ–¹æ³•

### æ–¹æ³•1: çŽ¯å¢ƒå˜é‡é…ç½® (æŽ¨è)

åœ¨Cloud Studioç»ˆç«¯ä¸­è®¾ç½®ï¼š
```bash
# HTTPä»£ç†
export http_proxy=http://proxy-server:port
export https_proxy=http://proxy-server:port

# æˆ–SOCKS5ä»£ç†
export http_proxy=socks5://proxy-server:port
export https_proxy=socks5://proxy-server:port

# å¯åŠ¨åº”ç”¨
python start_cloudstudio.py
```

### æ–¹æ³•2: Pythonä»£ç é…ç½®

ä¿®æ”¹ `src/api/tmdb_client.py` ä¸­çš„è¯·æ±‚é…ç½®ï¼š

```python
import requests
from requests.adapters import HTTPAdapter
from urllib3.util.retry import Retry

class TMDBClient:
    def __init__(self):
        self.session = requests.Session()
        
        # é…ç½®ä»£ç†
        proxies = {
            'http': 'http://proxy-server:port',
            'https': 'http://proxy-server:port'
        }
        self.session.proxies.update(proxies)
        
        # é…ç½®é‡è¯•ç­–ç•¥
        retry_strategy = Retry(
            total=3,
            backoff_factor=1,
            status_forcelist=[429, 500, 502, 503, 504],
        )
        adapter = HTTPAdapter(max_retries=retry_strategy)
        self.session.mount("http://", adapter)
        self.session.mount("https://", adapter)
```

### æ–¹æ³•3: é…ç½®æ–‡ä»¶æ–¹å¼

åœ¨ `config/config.yaml` ä¸­æ·»åŠ ä»£ç†é…ç½®ï¼š

```yaml
# TMDB APIé…ç½®
tmdb:
  api_key: "your_api_key"
  base_url: "https://api.themoviedb.org/3"
  
  # ä»£ç†é…ç½®
  proxy:
    enabled: true
    http_proxy: "http://proxy-server:port"
    https_proxy: "http://proxy-server:port"
    # æˆ–ä½¿ç”¨SOCKS5
    # http_proxy: "socks5://proxy-server:port"
    # https_proxy: "socks5://proxy-server:port"
  
  # è¯·æ±‚é…ç½®
  timeout: 30
  max_retries: 3
  retry_delay: 2
```

ç„¶åŽä¿®æ”¹ä»£ç è¯»å–é…ç½®ï¼š
```python
def __init__(self):
    self.tmdb_config = config.get_tmdb_config()
    self.proxy_config = self.tmdb_config.get('proxy', {})
    
    self.session = requests.Session()
    
    # è®¾ç½®ä»£ç†
    if self.proxy_config.get('enabled', False):
        proxies = {
            'http': self.proxy_config.get('http_proxy'),
            'https': self.proxy_config.get('https_proxy')
        }
        self.session.proxies.update(proxies)
```

## ðŸ”‘ **å…è´¹ä»£ç†èµ„æº**

### å…¬å…±ä»£ç†æœåŠ¡
1. **å…è´¹HTTPä»£ç†**:
   - http://proxy-list.org/
   - https://www.proxy-list.download/
   - https://free-proxy-list.net/

2. **å…è´¹SOCKS5ä»£ç†**:
   - https://www.socks-proxy.net/
   - https://sockslist.net/

### ä»£ç†éªŒè¯
```bash
# æµ‹è¯•ä»£ç†æ˜¯å¦å¯ç”¨
curl -x http://proxy-server:port https://api.themoviedb.org/3

# æµ‹è¯•SOCKS5ä»£ç†
curl --socks5 proxy-server:port https://api.themoviedb.org/3
```

## ðŸš€ **å®žç”¨ä»£ç†æ–¹æ¡ˆ**

### æŽ¨èé…ç½®ç»„åˆ

#### 1. è½®æ¢ä»£ç†ç­–ç•¥
```python
# å¤šä¸ªä»£ç†è½®æ¢ä½¿ç”¨
proxy_list = [
    "http://proxy1:port",
    "http://proxy2:port", 
    "http://proxy3:port"
]

import random

def get_random_proxy():
    return {
        'http': random.choice(proxy_list),
        'https': random.choice(proxy_list)
    }

# åœ¨è¯·æ±‚ä¸­ä½¿ç”¨
response = requests.get(url, proxies=get_random_proxy())
```

#### 2. æ™ºèƒ½é™çº§ç­–ç•¥
```python
def _make_request_with_fallback(self, endpoint, params=None):
    """å¸¦é™çº§çš„APIè¯·æ±‚"""
    
    # 1. å°è¯•ç›´è¿ž
    try:
        return self._make_request_direct(endpoint, params)
    except:
        pass
    
    # 2. å°è¯•ä»£ç†
    try:
        return self._make_request_with_proxy(endpoint, params)
    except:
        pass
    
    # 3. ä½¿ç”¨å¤‡ç”¨æ•°æ®
    return self._get_fallback_data(endpoint, params)
```

## ðŸ”§ **Cloud Studio ç‰¹å®šé…ç½®**

### ä¸´æ—¶ä»£ç†è®¾ç½®
```bash
# åœ¨Cloud Studioç»ˆç«¯ä¸­ä¸´æ—¶è®¾ç½®
export http_proxy=http://your-proxy:port
export https_proxy=http://your-proxy:port
export no_proxy=localhost,127.0.0.1

# éªŒè¯ä»£ç†è®¾ç½®
echo $http_proxy
echo $https_proxy

# æµ‹è¯•ç½‘ç»œè¿žæŽ¥
curl -x $http_proxy https://api.themoviedb.org/3
```

### æŒä¹…åŒ–ä»£ç†è®¾ç½®
```bash
# å°†ä»£ç†é…ç½®å†™å…¥çŽ¯å¢ƒæ–‡ä»¶
cat >> ~/.bashrc << EOF
export http_proxy=http://your-proxy:port
export https_proxy=http://your-proxy:port
EOF

# é‡æ–°åŠ è½½çŽ¯å¢ƒ
source ~/.bashrc
```

## âš ï¸ **æ³¨æ„äº‹é¡¹**

### ä»£ç†å®‰å…¨æ€§
1. **å…è´¹ä»£ç†é£Žé™©**: å¯èƒ½ä¸ç¨³å®šæˆ–ä¸å®‰å…¨
2. **APIå¯†é’¥ä¿æŠ¤**: ç¡®ä¿ä»£ç†æœåŠ¡å¯ä¿¡
3. **æ•°æ®éšç§**: æ³¨æ„ä»£ç†å¯èƒ½è®°å½•è¯·æ±‚å†…å®¹

### æ€§èƒ½è€ƒè™‘
1. **å»¶è¿Ÿå¢žåŠ **: ä»£ç†ä¼šå¢žåŠ è¯·æ±‚å»¶è¿Ÿ
2. **ç¨³å®šæ€§**: å…è´¹ä»£ç†å¯èƒ½ä¸ç¨³å®š
3. **é€Ÿåº¦é™åˆ¶**: ä»£ç†å¯èƒ½æœ‰é€Ÿåº¦é™åˆ¶

## ðŸŽ¯ **å®žé™…æ“ä½œå»ºè®®**

### å¯¹äºŽCloud Studioæ¼”ç¤º

**æœ€ç®€å•çš„æ–¹æ¡ˆ**ï¼š
```bash
# 1. æ‰¾ä¸€ä¸ªå…è´¹HTTPä»£ç†
# è®¿é—® http://proxy-list.org/ èŽ·å–ä»£ç†åœ°å€

# 2. åœ¨Cloud Studioä¸­è®¾ç½®
export http_proxy=http://proxy-ip:proxy-port
export https_proxy=http://proxy-ip:proxy-port

# 3. æµ‹è¯•è¿žæŽ¥
curl -x $http_proxy https://api.themoviedb.org/3

# 4. å¯åŠ¨åº”ç”¨
python start_cloudstudio.py
```

### å¤‡ç”¨æ–¹æ¡ˆ
å¦‚æžœä»£ç†ä¹Ÿä¸ç¨³å®šï¼Œå»ºè®®ï¼š
1. **ä¸“æ³¨äºŽæŠ€æœ¯å±•ç¤º**: é‡ç‚¹å±•ç¤ºä»£ç æž¶æž„å’Œç•Œé¢è®¾è®¡
2. **ä½¿ç”¨æµ‹è¯•æ•°æ®**: å‡†å¤‡ä¸€äº›æµ‹è¯•å›¾ç‰‡è¿›è¡ŒçŽ°åœºè¯†åˆ«
3. **æœ¬åœ°æ¼”ç¤º**: åœ¨æœ¬åœ°çŽ¯å¢ƒå±•ç¤ºå®Œæ•´åŠŸèƒ½
4. **å½•åˆ¶æ¼”ç¤ºè§†é¢‘**: æå‰å½•åˆ¶åŠŸèƒ½æ¼”ç¤ºè§†é¢‘

**è®°ä½ï¼šå³ä½¿APIä¸å¯ç”¨ï¼Œæ‚¨çš„é¡¹ç›®ä»ç„¶å±•ç¤ºäº†å®Œæ•´çš„AIç³»ç»Ÿæž¶æž„å’ŒæŠ€æœ¯èƒ½åŠ›ï¼** ðŸŽ‰
